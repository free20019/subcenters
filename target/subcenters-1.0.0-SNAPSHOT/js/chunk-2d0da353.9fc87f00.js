(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0da353"],{"6b2c":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("t-query-panel",{attrs:{model:e.query,footer:"300"},scopedSlots:e._u([{key:"querybar",fn:function(){return[a("el-form-item",[a("el-date-picker",{attrs:{type:"date",placeholder:"开始时间"},model:{value:e.query.startTime,callback:function(t){e.$set(e.query,"startTime",t)},expression:"query.startTime"}})],1),a("el-form-item",[a("el-date-picker",{attrs:{type:"date",placeholder:"结束时间"},model:{value:e.query.endTime,callback:function(t){e.$set(e.query,"endTime",t)},expression:"query.endTime"}})],1),a("el-form-item",[a("el-autocomplete",{attrs:{"prefix-icon":e.iconClassName("icon-car"),"fetch-suggestions":e.handleVehicleQuerySearch,"trigger-on-focus":!1,placeholder:"原车牌号码"},model:{value:e.query.vehicle,callback:function(t){e.$set(e.query,"vehicle",t)},expression:"query.vehicle"}})],1),a("el-form-item",[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"新车牌号码"},model:{value:e.query.new_vehicle,callback:function(t){e.$set(e.query,"new_vehicle",t)},expression:"query.new_vehicle"}},e._l(e.select.new_vehicle,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleQueryClick}},[e._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleExportClick}},[e._v("导出")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleTableAddClick}},[e._v("添加")])],1)]},proxy:!0}])},[a("t-table-page",{attrs:{data:e.table.data,loading:e.table.display,"page-size":20}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50",resizable:!1}}),a("el-table-column",{attrs:{prop:"OLD_VEHICLE_NO",label:"原车牌号码",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"NEW_VEHICLE_NO",label:"现车牌号码",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"APPLY_TIME",label:"申请时间",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"AUDIT_STATUS",label:"审核状态",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"AUDIT_TIME",label:"审核时间",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"AUDIT_REASON",label:"审核原因",align:"center","min-width":"160",resizable:!1}}),a("el-table-column",{attrs:{resizable:!1,width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",icon:"el-icon-edit",type:"text"},on:{click:function(a){return e.handleTableEditClick(t.row)}}}),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"text"},on:{click:function(a){return e.handleTableDeleteClick(t.row)}}})]}}])})],1),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.display,width:"400px"},on:{"update:visible":function(t){return e.$set(e.dialog,"display",t)},closed:e.handleDialogClosed}},[a("el-form",{ref:"form",attrs:{model:e.dialog.form,size:"small","label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"车牌号码"}},[a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"260px"},attrs:{placeholder:"车牌号码","fetch-suggestions":e.handleVehicleQuerySearch,"trigger-on-focus":!1},model:{value:e.dialog.form.vehicle,callback:function(t){e.$set(e.dialog.form,"vehicle",t)},expression:"dialog.form.vehicle"}})],1),a("el-form-item",{attrs:{label:"变更车牌号"}},[a("el-input",{staticStyle:{width:"260px"},attrs:{placeholder:"变更车牌号"},model:{value:e.dialog.form.new_vehicle,callback:function(t){e.$set(e.dialog.form,"new_vehicle",t)},expression:"dialog.form.new_vehicle"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.display=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleDialogSaveClick}},[e._v("提 交")])],1)],1)],1)},l=[],n=a("c1df"),c=a.n(n),o=a("0e08"),r=a("bc3a"),s=a.n(r),h=a("17fb"),d=a.n(h),u={name:"ApplicationRegardingChanges",data:function(){return{query:{startTime:"",endTime:"",vehicle:"",new_vehicle:""},inputVehicle:{loading:!1,option:[]},table:{display:!1,selectItem:[],data:[]},select:{vehicle:[],new_vehicle:[]},dialog:{title:"",display:!1,form:{vehicle:"",new_vehicle:""}}}},mounted:function(){this.query.startTime=new Date(c()().add("day",-1)),this.query.endTime=new Date,this.findChangeApplication(),this.getVehicle(),this.getNewVehicle()},methods:{iconClassName:o["m"],handleVehicleQuerySearch:function(e,t){if(e.length<3)return t([]);t(d.a.filter(this.select.vehicle,function(t){return t.value.indexOf(e)>-1}))},getVehicle:function(){var e=this;s.a.get("common/vehicle",{baseURL:o["a"],params:{type:1}}).then(function(t){e.select.vehicle=d.a.map(t.data,function(e){return{value:e.VEHICLE_NO}})}).catch(function(e){})},getNewVehicle:function(){var e=this;s.a.get("common/newVehicle",{baseURL:o["a"],params:{}}).then(function(t){e.select.new_vehicle=d.a.map(t.data,function(e){return{label:e.VEHICLE_NO,value:e.VEHICLE_NO}})}).catch(function(e){})},findChangeApplication:function(){var e=this,t=this.query,a=t.startTime,i=t.endTime,l=t.vehicle,n=t.new_vehicle;this.table.display=!0,s.a.get("letterManagement/findChangeApplication",{baseURL:o["a"],params:{startTime:a&&c()(a).format("YYYY-MM-DD"),endTime:i&&c()(i).format("YYYY-MM-DD"),vehicle:l,new_vehicle:n}}).then(function(t){e.table.data=t.data||[],e.table.display=!1}).catch(function(e){})},addChangeApplication:function(){var e=this,t=this.dialog.form,a=t.vehicle,i=t.new_vehicle;if(""===a||""===i)return this.$message.error("请填写完整信息！"),!1;s.a.get("letterManagement/addChangeApplication",{baseURL:o["a"],params:{vehicle:a,new_vehicle:i}}).then(function(t){t.data>0?(e.$message({message:"操作成功!",type:"success"}),e.dialog.display=!1,e.findChangeApplication(),e.getNewVehicle()):0===t.data?e.$message.error("操作失败！"):-1===t.data&&e.$message.error("该车辆已申请！")}).catch(function(e){})},updateChangeApplication:function(){var e=this,t=this.dialog.form,a=t.vehicle,i=t.new_vehicle;if(""===a||""===i)return this.$message.error("请填写完整信息！"),!1;s.a.get("letterManagement/updateChangeApplication",{baseURL:o["a"],params:{id:this.table.selectItem.ID,vehicle:a,new_vehicle:i}}).then(function(t){t.data>0?(e.$message({message:"操作成功!",type:"success"}),e.dialog.display=!1,e.findChangeApplication(),e.getNewVehicle()):0===t.data?e.$message.error("操作失败！"):-1===t.data&&e.$message.error("该车辆已申请！")}).catch(function(e){})},handleQueryClick:function(){this.findChangeApplication()},handleTableAddClick:function(){this.dialog.title="添加",this.dialog.display=!0},handleTableEditClick:function(e){this.dialog.title="修改",this.dialog.display=!0,this.table.selectItem=e,this.dialog.form.vehicle=e.OLD_VEHICLE_NO,this.dialog.form.new_vehicle=e.NEW_VEHICLE_NO},handleTableDeleteClick:function(e){var t=this;this.$confirm("是否删除?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then(function(){s.a.get("letterManagement/deleteChangeApplication",{baseURL:o["a"],params:{id:e.ID}}).then(function(e){e.data>0?(t.$message({message:"操作成功!",type:"success"}),t.findChangeApplication(),t.getNewVehicle()):t.$message.error("操作失败！")}).catch(function(e){})}).catch(function(){})},handleDialogSaveClick:function(){"修改"===this.dialog.title?this.updateChangeApplication():"添加"===this.dialog.title&&this.addChangeApplication()},handleDialogClosed:function(){this.dialog.title="",this.dialog.form.vehicle="",this.dialog.form.new_vehicle="",this.table.selectItem=[]},handleExportClick:function(){var e=this.query,t=e.startTime,a=e.endTime,i=e.vehicle,l=e.new_vehicle;this.$confirm("是否需要导出?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then(function(){window.open("".concat(o["a"],"letterManagement/findChangeApplicationExcel?startTime=").concat(t&&c()(t).format("YYYY-MM-DD"),"&endTime=").concat(a&&c()(a).format("YYYY-MM-DD"),"&vehicle=").concat(i,"&new_vehicle=").concat(l))}).catch(function(){})}}},p=u,m=a("2877"),f=Object(m["a"])(p,i,l,!1,null,null,null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-2d0da353.9fc87f00.js.map