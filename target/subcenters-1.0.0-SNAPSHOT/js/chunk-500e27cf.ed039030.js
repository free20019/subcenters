(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-500e27cf"],{"1f5b":function(e,t){e.exports="data:image/png;base64,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"},"8d6c":function(e,t,a){"use strict";var i=a("d7a5"),s=a.n(i);s.a},c41e:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("t-layout",{directives:[{name:"loading",rawName:"v-loading",value:e.table.gpsData.loading,expression:"table.gpsData.loading"}],attrs:{border:"",right:"273"},scopedSlots:e._u([{key:"right",fn:function(){return[a("div",{staticClass:"tw-calendar no-footer",attrs:{id:"calendar"}}),a("el-form",{staticClass:"tw-form",attrs:{model:e.vehicleQuery,size:"small"}},[a("el-form-item",[a("el-select",{attrs:{"remote-method":e.handleVehicleQueryRemoteMethod,remote:"",filterable:"","reserve-keyword":"",placeholder:"车牌号码"},model:{value:e.vehicleQuery.vehicle,callback:function(t){e.$set(e.vehicleQuery,"vehicle",t)},expression:"vehicleQuery.vehicle"}},e._l(e.vehicleOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),a("div",{staticStyle:{display:"none"}},[e._v(e._s(e.getHTAddress))])],1),a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime",placeholder:"开始时间"},model:{value:e.vehicleQuery.startTime,callback:function(t){e.$set(e.vehicleQuery,"startTime",t)},expression:"vehicleQuery.startTime"}})],1),a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime",placeholder:"开始时间"},model:{value:e.vehicleQuery.endTime,callback:function(t){e.$set(e.vehicleQuery,"endTime",t)},expression:"vehicleQuery.endTime"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleQueryClick}},[e._v("查询")])],1),a("el-form-item",{attrs:{"label-width":"9em"},scopedSlots:e._u([{key:"label",fn:function(){return[a("el-button",{attrs:{type:"text",icon:e.playIconType},on:{click:e.handlePlayClick}}),a("el-button",{attrs:{type:"text",icon:"iconfont icon-stop"},on:{click:e.handleStopClick}}),e._v(" 速度：\n        ")]},proxy:!0}])},[a("el-slider",{attrs:{min:1,max:10},on:{change:e.handleVehicleSpeedChange},model:{value:e.vehicleQuery.speed,callback:function(t){e.$set(e.vehicleQuery,"speed",t)},expression:"vehicleQuery.speed"}})],1)],1),a("t-panel",{staticClass:"no-radius",attrs:{title:"点位状态",size:"small"}},[a("el-row",{staticClass:"tw-item"},[a("el-col",{attrs:{span:12}},[e._v("速度："+e._s(e.info.speed))]),a("el-col",{attrs:{span:12}},[e._v("方向："+e._s(e.info.fx))])],1),a("el-row",{staticClass:"tw-item"},[a("el-col",{attrs:{span:12}},[e._v("经度："+e._s(e.info.px))]),a("el-col",{attrs:{span:12}},[e._v("纬度："+e._s(e.info.py))])],1),a("el-row",{staticClass:"tw-item"},[a("el-col",{attrs:{span:12}},[e._v("当前里程："+e._s(e.info.dqlc))]),a("el-col",{attrs:{span:12}},[e._v("合计里程："+e._s(e.info.zlc))])],1),a("el-row",{staticClass:"tw-item"},[a("el-col",{attrs:{span:24}},[e._v("GPS时间："+e._s(e.info.time))])],1),a("el-row",{staticClass:"tw-item"},[a("el-col",{attrs:{span:12}},[e._v("状态："+e._s(e.info.zt))])],1)],1)]},proxy:!0}])},[a("t-layout",{attrs:{border:"","footer-strip":"",footer:"360"},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-slider",{staticStyle:{"padding-left":"20px","padding-right":"20px"},attrs:{max:e.table.gpsData.data.length},model:{value:e.map.playFrame,callback:function(t){e.$set(e.map,"playFrame",t)},expression:"map.playFrame"}}),a("el-tabs",{staticClass:"tw-tabs tw-full",staticStyle:{height:"calc(100% - 38px)"},attrs:{"tab-position":"bottom",type:"border-card"},on:{"tab-click":e.test},model:{value:e.tabs.active,callback:function(t){e.$set(e.tabs,"active",t)},expression:"tabs.active"}},[a("el-tab-pane",{attrs:{label:"GPS数据",name:"GPSData"}},[a("t-query-panel",{scopedSlots:e._u([{key:"querybar",fn:function(){return[a("el-form-item",[a("el-button",{attrs:{type:"primary"}},[e._v("导出")])],1)]},proxy:!0}])},[a("el-table",{directives:[{name:"scrollbar",rawName:"v-scrollbar:table",arg:"table"}],staticClass:"tw-table",attrs:{data:e.freezeData(e.table.gpsData.data),size:"small",border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),a("el-table-column",{attrs:{prop:"COMP_NAME",label:"公司","min-width":"120",align:"center"}}),a("el-table-column",{attrs:{prop:"VEHICLE_NUM",label:"车牌号码",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"SPEED_TIME",label:"时间",width:"160",align:"center",formatter:e.formatterTDateTime}}),a("el-table-column",{attrs:{prop:"STATE",label:"车辆状态",width:"100",align:"center",formatter:e.formatterTVehicleType}}),a("el-table-column",{attrs:{prop:"PX",label:"经度",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"PY",label:"纬度",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"DIRECTION",label:"方向",width:"100",align:"center",formatter:e.formatterTDirectionType}}),a("el-table-column",{attrs:{prop:"SPEED",label:"GPS速度 km/h",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"MILEAGE",label:"总里程 km",width:"100",align:"center"}})],1)],1)],1),a("el-tab-pane",{attrs:{label:"速度曲线",name:"second"}},[a("div",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"speedecharts"}})])],1)]},proxy:!0}])},[a("div",{staticClass:"tw-map-panel",attrs:{id:"baidu-map"}})])],1)},s=[],n=(a("96cf"),a("3b8d")),r=a("bc3a"),l=a.n(r),o=a("17fb"),c=a.n(o),p=a("c1df"),h=a.n(p),m=a("0e08"),d=function(e,t,a,i){this._map=e,this._speed=i,this._marker=t,this._path=a,this._currentIndex=0,t.setMap(e),t.setPosition(a[0])};d.prototype.step=function(){var e=this._currentIndex+1;if(e<this._path.length){if(this._listenToMoveend||(this._listenToMoveend=AMap.event.addListener(this._marker,"moveend",function(){this._currentIndex++,AMap.event.trigger(this,"stepend")},this)),this._path[e].lng==this._path[this._currentIndex].lng&&this._path[e].lat==this._path[this._currentIndex].lat)return this._currentIndex++,void this.step();this._marker.moveTo(this._path[e],this._speed)}return this._currentIndex},d.prototype.move=function(){return this._listenToStepend||(this._listenToStepend=AMap.event.addListener(this,"stepend",function(){this.step()},this)),this.step(),this._currentIndex},d.prototype.stop=function(){this._marker.stopMove()},d.prototype.restart=function(){this._speed=1e3,this.stop(),this._marker.setPosition(this._path[0]),this._currentIndex=0,this.move()},d.prototype.speed=function(e){this._speed=200*e,this.move()},d.prototype.jingdu=function(e){this._currentIndex=e};var u=d,f=a("024c"),y=a.n(f),g=a("313e"),v=a.n(g),b=a("1f5b"),D=a.n(b),w={name:"HistoricalTrack",data:function(){return{map:{bmap:null,vehicleRoute:null,vehicleMarker:null,playType:0,playFrame:0,palytool:null,markerhistory:[],polyline:[],markerMovingControl:null},vehicleQuery:{vehicle:"",startTime:"",endTime:"",speed:5},vehicleOptions:[],tabs:{active:"GPSData"},table:{gpsData:{loading:!1,data:[],pageSize:100,currentPage:1,freeze:!0},vehicleRecord:{loading:!1,data:[],duration:2},alarmLocation:{loading:!1,data:[]},speedingSection:{loading:!1,data:[]},leftEChart:null},setIntervalgj:null,info:{speed:"",fx:"",px:"",py:"",dqlc:"",zlc:"",time:"",zt:""},geocoder:new y.a.Geocoder({city:"010",radius:1e3})}},mounted:function(){var e=this;this.vehicleQuery.startTime=h()(new Date((new Date).getTime()-36e5)).format("YYYY-MM-DD HH:mm:ss"),this.vehicleQuery.endTime=h()(new Date).format("YYYY-MM-DD HH:mm:ss"),this.vehicleQuery.vehicle=this.$cookies.get("setHTAddress")||"",this.$nextTick(function(){e.map.bmap=new y.a.Map("baidu-map",{resizeEnable:!0,zoom:12}),laydate.render({elem:"#calendar",position:"static"}),""!=e.vehicleQuery.vehicle&&(e.getHistoryList(),e.$cookies.remove("setHTAddress"))})},computed:{playIconType:function(){var e=1===this.map.playType?"icon-timeOut":"icon-play";return"iconfont ".concat(e)},getHTAddress:function(){return this.$cookies.get("setHTAddress")}},methods:{regeoCode:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t,a){var i,s,n,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=[t,a],s=new Promise(function(e,t){r.geocoder.getAddress(i,function(a,i){"complete"===a&&i.regeocode?e(i.regeocode.formattedAddress):t("无")})}),e.next=4,s;case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}},e)}));function t(t,a){return e.apply(this,arguments)}return t}(),getVehicleList:function(e){var t=this,a=new URLSearchParams;return a.append("vhic",e),l.a.post("map/getVhic",a,{baseURL:m["a"]}).then(function(e){t.vehicleOptions=c.a.map(e.data,function(e){return{value:e.VEHI_NO,label:e.VEHI_NO}})})},getHistoryList:function(){var e=this,t=this.vehicleQuery,a=t.vehicle,i=t.startTime,s=t.endTime,n=new URLSearchParams,r=a;return n.append("vhic",a),n.append("stime",h()(i).format("YYYY-MM-DD HH:mm:ss")),n.append("etime",h()(s).format("YYYY-MM-DD HH:mm:ss")),this.table.gpsData.loading=!0,l.a.post("map/getHistory",n,{baseURL:m["a"]}).then(function(t){e.vehicleQuery.vehicle=r,e.map.bmap.clearMap();var a=[];e.table.gpsData.data=[];c.a.map(t.data,function(e){a.push(new y.a.LngLat(e.PX,e.PY))}),e.addLine(a),e.map.markerMovingControl=new u(e.map.bmap,e.map.markerhistory,a,1e3),e.table.gpsData.data=t.data,e.table.gpsData.loading=!1})},addLine:function(e){this.map.markerhistory=new y.a.Marker({map:this.map.bmap,position:e[0],icon:D.a,zIndex:101,offset:new y.a.Pixel(-26,-13),autoRotation:!0}),this.map.polyline=new y.a.Polyline({map:this.map.bmap,path:e,showDir:!0,strokeColor:"#28F",strokeWeight:3}),this.map.bmap.setFitView()},test:function(){"second"===this.tabs.active&&setTimeout(this.speedecharts,500)},speedecharts:function(){var e=[],t=[];c.a.map(this.table.gpsData.data,function(a){t.push(h()(a.SPEED_TIME).format("YYYY-MM-DD HH:mm:ss")),e.push(a.SPEED)}),this.leftEChart=v.a.init(document.getElementById("speedecharts")),this.leftEChart.setOption({tooltip:{trigger:"axis"},legend:{data:["速度曲线"]},xAxis:{type:"category",boundaryGap:!1,data:t},yAxis:{type:"value",axisLabel:{formatter:"{value} (KM/H)"}},series:[{name:"时速",type:"line",data:e,markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]}}]}),this.leftEChart.resize()},handleTablePageCurrentChange:function(e){this.table.gpsData.currentPage=e},handleVehicleQueryRemoteMethod:function(e){e.length<3||this.getVehicleList(e)},handlePlayClick:function(){var e=this,t=this.map.playType;if(0===this.table.gpsData.data.length)return this.$message({message:"无数据不支持播放",type:"warning"});0===t?(this.map.playType=1,this.setIntervalgj=setInterval(function(){e.haldlestep()},200)):(this.map.playType=0,clearInterval(this.setIntervalgj),this.map.markerMovingControl.stop())},haldlestep:function(){var e=this.map.markerMovingControl.step();e==this.table.gpsData.data.length&&clearInterval(this.setIntervalgj),this.map.playFrame=e,this.info.speed=this.table.gpsData.data[e].SPEED,this.info.fx=this.formatterDirectionType(this.table.gpsData.data[e].DIRECTION),this.info.px=this.table.gpsData.data[e].PX,this.info.py=this.table.gpsData.data[e].PY,this.info.dqlc=this.table.gpsData.data[e].MILEAGE,this.info.zlc=this.table.gpsData.data[this.table.gpsData.data.length-1].MILEAGE,this.info.time=h()(this.table.gpsData.data[e].SPEED_TIME).format("YYYY-MM-DD HH:mm:ss"),this.info.zt=1==this.table.gpsData.data[e].STATE?"重车":"空车"},handleStopClick:function(){this.map.playType=1,this.map.playFrame=0,this.map.markerMovingControl.restart()},handleQueryClick:function(){console.info("handleQueryClick"),this.getHistoryList()},handleVehicleSpeedChange:function(){this.map.markerMovingControl.speed(this.vehicleQuery.speed)},playVehicle:function(){},vehicleTimeout:function(){},resetVehiclePosition:function(){},freezeData:m["h"],formatterTDateTime:m["d"],formatterTVehicleType:m["g"],formatterDirectionType:m["c"],formatterTDirectionType:m["e"]},watch:{"map.playFrame":function(e){e&&(this.map.markerMovingControl.jingdu(e),this.map.markerhistory.setAngle(parseInt(this.table.gpsData.data[e].DIRECTION)-90),this.map.markerhistory.setPosition(new y.a.LngLat(this.table.gpsData.data[e].PX,this.table.gpsData.data[e].PY)))}}},T=w,A=(a("8d6c"),a("2877")),k=Object(A["a"])(T,i,s,!1,null,"72c9b508",null);t["default"]=k.exports},d7a5:function(e,t,a){}}]);
//# sourceMappingURL=chunk-500e27cf.ed039030.js.map