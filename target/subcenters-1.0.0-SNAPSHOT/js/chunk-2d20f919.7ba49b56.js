(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20f919"],{b3d6:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("t-query-panel",{attrs:{model:e.query,footer:"300"},scopedSlots:e._u([{key:"querybar",fn:function(){return[a("el-form-item",[a("el-date-picker",{attrs:{type:"date",placeholder:"开始时间"},model:{value:e.query.startTime,callback:function(t){e.$set(e.query,"startTime",t)},expression:"query.startTime"}})],1),a("el-form-item",[a("el-date-picker",{attrs:{type:"date",placeholder:"结束时间"},model:{value:e.query.endTime,callback:function(t){e.$set(e.query,"endTime",t)},expression:"query.endTime"}})],1),a("el-form-item",[a("el-autocomplete",{attrs:{"prefix-icon":e.iconClassName("icon-car"),"fetch-suggestions":e.handleCompanyQuerySearch,"trigger-on-focus":!1,placeholder:"公司名称"},model:{value:e.query.company,callback:function(t){e.$set(e.query,"company",t)},expression:"query.company"}})],1),a("el-form-item",[a("el-autocomplete",{attrs:{"prefix-icon":e.iconClassName("icon-car"),"fetch-suggestions":e.handleVehicleQuerySearch,"trigger-on-focus":!1,placeholder:"车牌号码"},model:{value:e.query.vehicle,callback:function(t){e.$set(e.query,"vehicle",t)},expression:"query.vehicle"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleQueryClick}},[e._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleExportClick}},[e._v("导出")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleTableAddClick}},[e._v("添加")])],1)]},proxy:!0}])},[a("t-table-page",{attrs:{data:e.table.data,loading:e.table.display,"page-size":20}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50",resizable:!1,fixed:""}}),a("el-table-column",{attrs:{prop:"VEHICLE_NO",label:"车号",width:"120",align:"center",fixed:""}}),a("el-table-column",{attrs:{prop:"COMPANY_NAME",label:"公司",width:"220",align:"center"}}),a("el-table-column",{attrs:{prop:"VEHICLE_TYPE",label:"车型",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"VEHICLE_COLOR",label:"车辆颜色",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"FUEL_TYPE",label:"燃料类型",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"TERMINAL_TYPE",label:"终端类型",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"TERMINAL_MODEL",label:"终端型号",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"OWNER_NAME",label:"车主姓名",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"OWNER_PHONE",label:"电话号码",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"DAY_PERSON",label:"白班姓名",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"NIGHT_PERSON",label:"夜班姓名",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"DAY_PHONE",label:"白班电话",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"NIGHT_PHONE",label:"夜班电话",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"APPLICATION_DATE",label:"申请时间",width:"180",align:"center"}}),a("el-table-column",{attrs:{prop:"AUDIT_DATE",label:"审核时间",width:"180",align:"center"}}),a("el-table-column",{attrs:{prop:"REAL_NAME",label:"审核人员",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"AUDIT_REASON",label:"审核原因",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"AUDIT_STATUS",label:"审核状态",align:"center","min-width":"120",resizable:!1}}),a("el-table-column",{attrs:{resizable:!1,width:"100",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",icon:"el-icon-edit",type:"text"},on:{click:function(a){return e.handleTableEditClick(t.row)}}}),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"text"},on:{click:function(a){return e.handleTableDeleteClick(t.row)}}})]}}])})],1),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.display,width:"800px"},on:{"update:visible":function(t){return e.$set(e.dialog,"display",t)},closed:e.handleDialogClosed}},[a("el-form",{ref:"form",attrs:{model:e.dialog.form,size:"small","label-width":"100px","label-position":"right",inline:!0}},[a("el-form-item",{attrs:{label:"车号"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"车号"},model:{value:e.dialog.form.vehicle,callback:function(t){e.$set(e.dialog.form,"vehicle",t)},expression:"dialog.form.vehicle"}})],1),a("el-form-item",{attrs:{label:"公司"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"公司"},model:{value:e.dialog.form.company,callback:function(t){e.$set(e.dialog.form,"company",t)},expression:"dialog.form.company"}})],1),a("el-form-item",{attrs:{label:"车型"}},[a("el-select",{staticStyle:{width:"220px"},attrs:{filterable:"",placeholder:"车型"},model:{value:e.dialog.form.vehicleType,callback:function(t){e.$set(e.dialog.form,"vehicleType",t)},expression:"dialog.form.vehicleType"}},e._l(e.select.vehicleType,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"车辆颜色"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"车辆颜色"},model:{value:e.dialog.form.vehicleColor,callback:function(t){e.$set(e.dialog.form,"vehicleColor",t)},expression:"dialog.form.vehicleColor"}})],1),a("el-form-item",{attrs:{label:"燃料类型"}},[a("el-select",{staticStyle:{width:"220px"},attrs:{filterable:"",placeholder:"燃料类型"},model:{value:e.dialog.form.fuelType,callback:function(t){e.$set(e.dialog.form,"fuelType",t)},expression:"dialog.form.fuelType"}},e._l(e.select.fuelType,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"终端类型"}},[a("el-select",{staticStyle:{width:"220px"},attrs:{filterable:"",placeholder:"终端类型"},model:{value:e.dialog.form.terminalType,callback:function(t){e.$set(e.dialog.form,"terminalType",t)},expression:"dialog.form.terminalType"}},e._l(e.select.terminalType,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"终端型号"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"终端型号"},model:{value:e.dialog.form.terminalModel,callback:function(t){e.$set(e.dialog.form,"terminalModel",t)},expression:"dialog.form.terminalModel"}})],1),a("el-form-item",{attrs:{label:"车主姓名"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"车主姓名"},model:{value:e.dialog.form.ownerName,callback:function(t){e.$set(e.dialog.form,"ownerName",t)},expression:"dialog.form.ownerName"}})],1),a("el-form-item",{attrs:{label:"电话号码"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"电话号码"},model:{value:e.dialog.form.ownerPhone,callback:function(t){e.$set(e.dialog.form,"ownerPhone",t)},expression:"dialog.form.ownerPhone"}})],1),a("el-form-item",{attrs:{label:"白班姓名"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"白班姓名"},model:{value:e.dialog.form.dayPerson,callback:function(t){e.$set(e.dialog.form,"dayPerson",t)},expression:"dialog.form.dayPerson"}})],1),a("el-form-item",{attrs:{label:"夜班姓名"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"夜班姓名"},model:{value:e.dialog.form.nightPerson,callback:function(t){e.$set(e.dialog.form,"nightPerson",t)},expression:"dialog.form.nightPerson"}})],1),a("el-form-item",{attrs:{label:"白班电话"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"白班电话"},model:{value:e.dialog.form.dayPhone,callback:function(t){e.$set(e.dialog.form,"dayPhone",t)},expression:"dialog.form.dayPhone"}})],1),a("el-form-item",{attrs:{label:"夜班电话"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"夜班电话"},model:{value:e.dialog.form.nightPhone,callback:function(t){e.$set(e.dialog.form,"nightPhone",t)},expression:"dialog.form.nightPhone"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.display=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleDialogSaveClick}},[e._v("提 交")])],1)],1)],1)},i=[],o=a("c1df"),n=a.n(o),r=a("0e08"),c=a("bc3a"),s=a.n(c),d=a("17fb"),m=a.n(d),p={name:"DataAccessApplication",data:function(){return{query:{startTime:"",endTime:"",company:"",vehicle:""},inputVehicle:{loading:!1,option:[]},table:{display:!1,selectItem:[],data:[]},select:{vehicle:[],company:[],vehicleType:[],fuelType:[],terminalType:[]},dialog:{title:"",display:!1,form:{vehicle:"",company:"",vehicleType:"",vehicleColor:"",fuelType:"",terminalType:"",terminalModel:"",ownerName:"",ownerPhone:"",dayPerson:"",nightPerson:"",dayPhone:"",nightPhone:""}}}},mounted:function(){this.query.startTime=new Date(n()().add("day",-1)),this.query.endTime=new Date,this.findDataApplication(),this.getVehicle(),this.getCompany(),this.getFuelType(),this.getTerminalType(),this.getVehicleType()},methods:{iconClassName:r["m"],handleVehicleQuerySearch:function(e,t){if(e.length<3)return t([]);t(m.a.filter(this.select.vehicle,function(t){return t.value.indexOf(e)>-1}))},handleCompanyQuerySearch:function(e,t){t(m.a.filter(this.select.company,function(t){return t.value.indexOf(e)>-1}))},getVehicle:function(){var e=this;s.a.get("common/vehicle",{baseURL:r["a"],params:{type:1}}).then(function(t){e.select.vehicle=m.a.map(t.data,function(e){return{value:e.VEHICLE_NO}})}).catch(function(e){})},getCompany:function(){var e=this;s.a.get("common/company",{baseURL:r["a"],params:{type:1}}).then(function(t){e.select.company=m.a.map(t.data,function(e){return{value:e.COMPANY_NAME}})}).catch(function(e){})},getFuelType:function(){var e=this;s.a.get("common/fuelType",{baseURL:r["a"],params:{}}).then(function(t){e.select.fuelType=m.a.map(t.data,function(e){return{label:e.RLLX,value:e.RLLX}})}).catch(function(e){})},getTerminalType:function(){var e=this;s.a.get("common/terminalType",{baseURL:r["a"],params:{}}).then(function(t){e.select.terminalType=m.a.map(t.data,function(e){return{label:e.MT_NAME,value:e.MT_NAME}})}).catch(function(e){})},getVehicleType:function(){var e=this;s.a.get("common/vehicleType",{baseURL:r["a"],params:{}}).then(function(t){e.select.vehicleType=m.a.map(t.data,function(e){return{label:e.VT_NAME,value:e.VT_NAME}})}).catch(function(e){})},findDataApplication:function(){var e=this,t=this.query,a=t.startTime,l=t.endTime,i=t.company,o=t.vehicle;this.table.display=!0,s.a.get("letterManagement/findDataApplication",{baseURL:r["a"],params:{startTime:a&&n()(a).format("YYYY-MM-DD"),endTime:l&&n()(l).format("YYYY-MM-DD"),company:i,vehicle:o}}).then(function(t){e.table.data=t.data||[],e.table.display=!1}).catch(function(e){console.log(e)})},addDataApplication:function(){var e=this,t=this.dialog.form,a=t.vehicle,l=t.company,i=t.vehicleType,o=t.fuelType,n=t.terminalType,c=t.terminalModel,d=t.ownerName,m=t.ownerPhone,p=t.dayPerson,h=t.nightPerson,u=t.dayPhone,f=t.nightPhone,g=t.vehicleColor,y=/^(0|86|17951)?(13[0-9]|15[012356789]|17[01678]|18[0-9]|14[57])[0-9]{8}$/,b=/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/;return""===a||""===l||""===d||""===m?(this.$message.error("请填写完车牌号码，公司，车主姓名，车主电话！"),!1):!y.test(m)&&!b.test(m)&&""!==m||!y.test(u)&&!b.test(u)&&""!==u||!y.test(f)&&!b.test(f)&&""!==f?(this.$message.error("请填写正确手机号码！"),!1):void s.a.get("letterManagement/addDataApplication",{baseURL:r["a"],params:{vehicle:a,company:l,vehicleType:i,fuelType:o,terminalType:n,terminalModel:c,ownerName:d,ownerPhone:m,dayPerson:p,nightPerson:h,dayPhone:u,nightPhone:f,vehicleColor:g}}).then(function(t){t.data>0?(e.$message({message:"操作成功!",type:"success"}),e.dialog.display=!1,e.findDataApplication()):0===t.data?e.$message.error("操作失败！"):-1===t.data&&e.$message.error("该车辆已申请！")}).catch(function(e){console.error(e)})},updateDataApplication:function(){var e=this,t=this.dialog.form,a=t.vehicle,l=t.company,i=t.vehicleType,o=t.fuelType,n=t.terminalType,c=t.terminalModel,d=t.ownerName,m=t.ownerPhone,p=t.dayPerson,h=t.nightPerson,u=t.dayPhone,f=t.nightPhone,g=t.vehicleColor,y=/^(0|86|17951)?(13[0-9]|15[012356789]|17[01678]|18[0-9]|14[57])[0-9]{8}$/,b=/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/;return""===a||""===l||""===d||""===m?(this.$message.error("请填写完车牌号码，公司，车主姓名，车主电话！"),!1):!y.test(m)&&!b.test(m)&&""!==m||!y.test(u)&&!b.test(u)&&""!==u||!y.test(f)&&!b.test(f)&&""!==f?(this.$message.error("请填写正确手机号码！"),!1):void s.a.get("letterManagement/updateDataApplication",{baseURL:r["a"],params:{id:this.table.selectItem.ID,vehicle:a,company:l,vehicleType:i,fuelType:o,terminalType:n,terminalModel:c,ownerName:d,ownerPhone:m,dayPerson:p,nightPerson:h,dayPhone:u,nightPhone:f,vehicleColor:g}}).then(function(t){t.data>0?(e.$message({message:"操作成功!",type:"success"}),e.dialog.display=!1,e.findDataApplication()):0===t.data?e.$message.error("操作失败！"):-1===t.data&&e.$message.error("该车辆已申请！")}).catch(function(e){console.error(e)})},handleQueryClick:function(){this.findDataApplication()},handleTableAddClick:function(){this.dialog.title="添加",sessionStorage.setItem("username","测试"),this.dialog.form.company=sessionStorage.getItem("username"),this.dialog.display=!0},handleTableEditClick:function(e){this.dialog.title="修改",this.dialog.display=!0,this.table.selectItem=e,this.dialog.form.vehicle=e.VEHICLE_NO,this.dialog.form.company=e.COMPANY_NAME,this.dialog.form.vehicleType=e.VEHICLE_TYPE,this.dialog.form.vehicleColor=e.VEHICLE_COLOR,this.dialog.form.fuelType=e.FUEL_TYPE,this.dialog.form.terminalType=e.TERMINAL_TYPE,this.dialog.form.terminalModel=e.TERMINAL_MODEL,this.dialog.form.ownerName=e.OWNER_NAME,this.dialog.form.ownerPhone=e.OWNER_PHONE,this.dialog.form.dayPerson=e.DAY_PERSON,this.dialog.form.nightPerson=e.NIGHT_PERSON,this.dialog.form.dayPhone=e.DAY_PHONE,this.dialog.form.nightPhone=e.NIGHT_PHONE},handleTableDeleteClick:function(e){var t=this;this.$confirm("是否删除?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then(function(){s.a.get("letterManagement/deleteDataApplication",{baseURL:r["a"],params:{id:e.ID}}).then(function(e){e.data>0?(t.$message({message:"操作成功!",type:"success"}),t.findDataApplication()):t.$message.error("操作失败！")}).catch(function(e){console.error(e)})}).catch(function(){})},handleDialogSaveClick:function(){"修改"===this.dialog.title?this.updateDataApplication():"添加"===this.dialog.title&&this.addDataApplication()},handleDialogClosed:function(){this.dialog.title="",this.dialog.form.vehicle="",this.dialog.form.company="",this.dialog.form.vehicleType="",this.dialog.form.vehicleColor="",this.dialog.form.fuelType="",this.dialog.form.terminalType="",this.dialog.form.terminalModel="",this.dialog.form.ownerName="",this.dialog.form.ownerPhone="",this.dialog.form.dayPerson="",this.dialog.form.nightPerson="",this.dialog.form.dayPhone="",this.dialog.form.nightPhone="",this.table.selectItem=[]},handleExportClick:function(){var e=this.query,t=e.startTime,a=e.endTime,l=e.company,i=e.vehicle;this.$confirm("是否需要导出?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then(function(){window.open("".concat(r["a"],"letterManagement/findDataApplicationExcel?startTime=").concat(t&&n()(t).format("YYYY-MM-DD"),"&endTime=").concat(a&&n()(a).format("YYYY-MM-DD"),"&company=").concat(l,"&vehicle=").concat(i))}).catch(function(){})}}},h=p,u=a("2877"),f=Object(u["a"])(h,l,i,!1,null,null,null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-2d20f919.7ba49b56.js.map