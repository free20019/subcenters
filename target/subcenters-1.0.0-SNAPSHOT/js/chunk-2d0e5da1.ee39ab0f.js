(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e5da1"],{"95f5":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("t-query-panel",{attrs:{model:e.query,footer:"300"},scopedSlots:e._u([{key:"querybar",fn:function(){return[i("el-form-item",[i("el-date-picker",{attrs:{type:"datetime",placeholder:"开始时间"},model:{value:e.query.startTime,callback:function(t){e.$set(e.query,"startTime",t)},expression:"query.startTime"}})],1),i("el-form-item",[i("el-date-picker",{attrs:{type:"datetime",placeholder:"结束时间"},model:{value:e.query.endTime,callback:function(t){e.$set(e.query,"endTime",t)},expression:"query.endTime"}})],1),i("el-form-item",[i("el-input",{attrs:{"prefix-icon":e.iconClassName("icon-speed-limit"),placeholder:"限速值"},model:{value:e.query.limit,callback:function(t){e.$set(e.query,"limit",t)},expression:"query.limit"}})],1),i("el-form-item",[i("el-autocomplete",{attrs:{"prefix-icon":e.iconClassName("icon-car"),"fetch-suggestions":e.handleVehicleQuerySearch,"trigger-on-focus":!1,placeholder:"车牌号码"},model:{value:e.query.vehicle,callback:function(t){e.$set(e.query,"vehicle",t)},expression:"query.vehicle"}})],1),i("el-form-item",["1"===e.loginType?i("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择车辆组"},model:{value:e.query.vehicleGroupId,callback:function(t){e.$set(e.query,"vehicleGroupId",t)},expression:"query.vehicleGroupId"}},e._l(e.select.vehicleGroup,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e()],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.handleQueryClick}},[e._v("查询")]),i("el-button",{attrs:{type:"primary"},on:{click:e.handleExportClick}},[e._v("导出")])],1)]},proxy:!0},{key:"footer",fn:function(){return[i("div",{staticClass:"tw-chart",attrs:{id:"e-chart"}})]},proxy:!0}])},[i("t-table-page",{attrs:{data:e.table.data,loading:e.table.display}},[i("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50",resizable:!1}}),i("el-table-column",{attrs:{prop:"VEHICLE_NUM",label:"车牌号码",align:"center",width:"140"}}),i("el-table-column",{attrs:{prop:"STATE",label:"状态",align:"center",width:"120"}}),i("el-table-column",{attrs:{prop:"SPEED",label:"速度",align:"center",width:"120"}}),i("el-table-column",{attrs:{prop:"DIRECTION",label:"方向",align:"center",width:"120"}}),i("el-table-column",{attrs:{prop:"PX_PY",label:"经纬度",align:"center","min-width":"180",resizable:!1}})],1)],1)},l=[],r=i("c1df"),n=i.n(r),c=i("313e"),o=i.n(c),s=i("0e08"),u=i("bc3a"),h=i.n(u),m=i("17fb"),d=i.n(m),p={name:"SpeedCurveReport",data:function(){return{loginType:"",query:{startTime:"",endTime:"",limit:0,vehicle:"",vehicleGroupId:""},inputVehicle:{loading:!1,option:[]},table:{display:!1,data:[]},select:{vehicle:[],vehicleGroup:[]},chart:{el:null}}},mounted:function(){var e=this;this.query.startTime=new Date(n()().add("day",-1)),this.query.endTime=new Date,this.loginType=this.$cookies.get("loginType"),this.getVehicleGroup(),this.getVehicle(),this.$nextTick(function(){e.chart.el=o.a.init(document.getElementById("e-chart"))})},methods:{iconClassName:s["m"],getVehicleGroup:function(){var e=this;if("1"!==this.loginType)return null;h.a.get("common/vehicleGroup",{baseURL:s["a"],params:{userId:this.$cookies.get("userId")}}).then(function(t){e.select.vehicleGroup=d.a.map(t.data,function(e){return{value:e.CLZS,label:e.CLZ_NAME}})}).catch(function(e){})},setChart:function(e){var t=[],i=[];d.a.map(e,function(e){t.push(e.DB_TIME),i.push(e.SPEED)}),this.chart.el.clear(),this.chart.el.setOption({title:{text:"速度曲线报表"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:t},yAxis:{type:"value"},series:[{data:i,type:"line",smooth:!0}]})},handleVehicleQuerySearch:function(e,t){if(e.length<3)return t([]);t(d.a.filter(this.select.vehicle,function(t){return t.value.indexOf(e)>-1}))},getVehicle:function(){var e=this;h.a.get("common/vehicle",{baseURL:s["a"],params:{}}).then(function(t){e.select.vehicle=d.a.map(t.data,function(e){return{value:e.VEHICLE_NO}})}).catch(function(e){})},findSpeedCurve:function(){var e=this,t=this.query,i=t.startTime,a=t.endTime,l=t.limit,r=t.vehicle,c=t.vehicleGroupId;return r?i&&a?(i&&n()(i).format("YYYY-MM"))!==(a&&n()(a).format("YYYY-MM"))?this.$message.error("无法跨月查询！"):(this.table.display=!0,void h.a.get("queryAnalysis/findSpeedCurve",{baseURL:s["a"],params:{startTime:i&&n()(i).format("YYYY-MM-DD HH:mm:ss"),endTime:a&&n()(a).format("YYYY-MM-DD HH:mm:ss"),limit:l,vehicle:r,vehicleGroupId:c}}).then(function(t){e.table.data=d.a.map(t.data,function(e){return{VEHICLE_NUM:e.VEHICLE_NUM,STATE:e.STATE,SPEED:e.SPEED,DIRECTION:e.DIRECTION,PX_PY:e.PX+","+e.PY}}),e.setChart(t.data||[]),e.table.display=!1}).catch(function(e){})):this.$message.error("请选择时间！"):this.$message.error("请选择车牌号！")},handleQueryClick:function(){this.findSpeedCurve()},handleExportClick:function(){var e=this.query,t=e.startTime,i=e.endTime,a=e.limit,l=e.vehicle,r=e.vehicleGroupId;return l?t&&i?(t&&n()(t).format("YYYY-MM"))!==(i&&n()(i).format("YYYY-MM"))?this.$message.error("无法跨月查询！"):void this.$confirm("是否需要导出?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then(function(){window.open("".concat(s["a"],"queryAnalysis/findSpeedCurveExcel?startTime=").concat(t&&n()(t).format("YYYY-MM-DD HH:mm:ss"),"&endTime=").concat(i&&n()(i).format("YYYY-MM-DD HH:mm:ss"),"&limit=").concat(a,"&vehicle=").concat(l,"&vehicleGroupId=").concat(r))}).catch(function(){}):this.$message.error("请选择时间！"):this.$message.error("请选择车牌号！")}}},f=p,y=i("2877"),v=Object(y["a"])(f,a,l,!1,null,null,null);t["default"]=v.exports}}]);
//# sourceMappingURL=chunk-2d0e5da1.ee39ab0f.js.map