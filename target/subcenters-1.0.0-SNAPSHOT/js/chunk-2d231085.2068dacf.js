(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d231085"],{ef8f:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("t-query-panel",{attrs:{model:e.query,footer:"300"},scopedSlots:e._u([{key:"querybar",fn:function(){return[a("el-form-item",[a("el-date-picker",{attrs:{type:"date",disabled:e.timeControl,placeholder:"开始时间"},model:{value:e.query.startTime,callback:function(t){e.$set(e.query,"startTime",t)},expression:"query.startTime"}})],1),a("el-form-item",[a("el-date-picker",{attrs:{type:"date",disabled:e.timeControl,placeholder:"结束时间"},model:{value:e.query.endTime,callback:function(t){e.$set(e.query,"endTime",t)},expression:"query.endTime"}})],1),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.handleTimeTypeChange},model:{value:e.query.timeType,callback:function(t){e.$set(e.query,"timeType",t)},expression:"query.timeType"}},e._l(e.timeTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",[a("el-autocomplete",{attrs:{"prefix-icon":e.iconClassName("icon-car"),"fetch-suggestions":e.handleCompanyQuerySearch,"trigger-on-focus":!1,placeholder:"公司名称"},model:{value:e.query.company,callback:function(t){e.$set(e.query,"company",t)},expression:"query.company"}})],1),a("el-form-item",["1"===e.loginType?a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择车辆组"},model:{value:e.query.vehicleGroupId,callback:function(t){e.$set(e.query,"vehicleGroupId",t)},expression:"query.vehicleGroupId"}},e._l(e.select.vehicleGroup,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e()],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleQueryClick}},[e._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleExportClick}},[e._v("导出")])],1)]},proxy:!0}])},[a("t-table-page",{attrs:{data:e.table.data,loading:e.table.display,"page-size":20}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50",resizable:!1}}),a("el-table-column",{attrs:{prop:"COMP_NAME",label:"公司名称",align:"center",width:"240"}}),a("el-table-column",{attrs:{prop:"VEHI_NO",label:"车牌号码",align:"center",width:"120"}}),a("el-table-column",{attrs:{prop:"VEHI_SIM",label:"SIM卡号",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"MT_NAME",label:"终端类型",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"MDT_SUB_TYPE",label:"终端子类型",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"OWN_NAME",label:"联系人",align:"center",width:"120"}}),a("el-table-column",{attrs:{prop:"HOME_TEL",label:"联系电话",align:"center",width:"240"}}),a("el-table-column",{attrs:{prop:"TIME",label:"最后上线时间",align:"center","min-width":"140",resizable:!1}})],1)],1)},n=[],i=a("c1df"),r=a.n(i),o=a("0e08"),c=a("bc3a"),s=a.n(c),u=a("17fb"),m=a.n(u),p={name:"UnlistedVehicleInquiry",data:function(){return{loginType:"",query:{startTime:"",endTime:"",timeType:2,company:"",vehicleGroupId:""},timeControl:!0,timeTypeOptions:[{label:"自定义时间",value:0},{label:"3天时间",value:1},{label:"7天时间",value:2}],table:{display:!1,data:[]},select:{company:[],vehicleGroup:[]}}},mounted:function(){this.query.startTime=r()(r()().subtract(8,"days").format("YYYY-MM-DD")),this.query.endTime=r()(r()().subtract(1,"days").format("YYYY-MM-DD")),this.loginType=this.$cookies.get("loginType"),this.getVehicleGroup(),this.findUnlistedVehicle(),this.getCompany()},methods:{iconClassName:o["m"],getVehicleGroup:function(){var e=this;if("1"!==this.loginType)return null;s.a.get("common/vehicleGroup",{baseURL:o["a"],params:{userId:this.$cookies.get("userId")}}).then(function(t){e.select.vehicleGroup=m.a.map(t.data,function(e){return{value:e.CLZS,label:e.CLZ_NAME}})}).catch(function(e){})},handleCompanyQuerySearch:function(e,t){t(m.a.filter(this.select.company,function(t){return t.value.indexOf(e)>-1}))},getCompany:function(){var e=this;s.a.get("common/company",{baseURL:o["a"],params:{}}).then(function(t){e.select.company=m.a.map(t.data,function(e){return{value:e.COMPANY_NAME}})}).catch(function(e){console.log(e)})},findUnlistedVehicle:function(){var e=this,t=this.query,a=t.startTime,l=t.endTime,n=t.company,i=t.vehicleGroupId;if(!a||!l)return this.$message.error("请选择时间！");this.table.display=!0,s.a.get("dataStatistics/findUnlistedVehicle",{baseURL:o["a"],params:{startTime:a&&r()(a).format("YYYY-MM-DD"),endTime:l&&r()(l).format("YYYY-MM-DD"),company:n,vehicleGroupId:i}}).then(function(t){console.log("1111111111111",t),e.table.data=t.data||[],e.table.display=!1}).catch(function(e){console.log(e)})},handleTimeTypeChange:function(){switch(this.query.timeType){case 0:this.timeControl=!1;break;case 1:this.timeControl=!0,this.query.startTime=r()(r()().subtract(4,"days").format("YYYY-MM-DD")),this.query.endTime=r()(r()().subtract(1,"days").format("YYYY-MM-DD"));break;case 2:this.timeControl=!0,this.query.startTime=r()(r()().subtract(8,"days").format("YYYY-MM-DD")),this.query.endTime=r()(r()().subtract(1,"days").format("YYYY-MM-DD"));break}},handleQueryClick:function(){this.findUnlistedVehicle()},handleExportClick:function(){var e=this.query,t=e.startTime,a=e.endTime,l=e.company,n=e.vehicleGroupId;if(!t||!a)return this.$message.error("请选择时间！");this.$confirm("是否需要导出?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then(function(){window.open("".concat(o["a"],"dataStatistics/findUnlistedVehicleExcel?startTime=").concat(t&&r()(t).format("YYYY-MM-DD"),"&endTime=").concat(a&&r()(a).format("YYYY-MM-DD"),"&company=").concat(l,"&vehicleGroupId=").concat(n))}).catch(function(){})}}},d=p,h=a("2877"),y=Object(h["a"])(d,l,n,!1,null,null,null);t["default"]=y.exports}}]);
//# sourceMappingURL=chunk-2d231085.2068dacf.js.map