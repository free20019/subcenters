(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a3e2a"],{"03a2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("t-query-panel",{attrs:{model:e.query,footer:"300"},scopedSlots:e._u([{key:"querybar",fn:function(){return[a("el-form-item",[a("el-date-picker",{attrs:{type:"date",placeholder:"开始时间"},model:{value:e.query.startTime,callback:function(t){e.$set(e.query,"startTime",t)},expression:"query.startTime"}})],1),a("el-form-item",[a("el-date-picker",{attrs:{type:"date",placeholder:"结束时间"},model:{value:e.query.endTime,callback:function(t){e.$set(e.query,"endTime",t)},expression:"query.endTime"}})],1),a("el-form-item",[a("el-autocomplete",{attrs:{"prefix-icon":e.iconClassName("icon-car"),"fetch-suggestions":e.handleVehicleQuerySearch,"trigger-on-focus":!1,placeholder:"车牌号码"},model:{value:e.query.vehicle,callback:function(t){e.$set(e.query,"vehicle",t)},expression:"query.vehicle"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleQueryClick}},[e._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleExportClick}},[e._v("导出")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleTableAddClick}},[e._v("添加")])],1)]},proxy:!0}])},[a("t-table-page",{attrs:{data:e.table.data,loading:e.table.display,"page-size":20}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50",resizable:!1}}),a("el-table-column",{attrs:{prop:"COMPANY_NAME",label:"公司名称",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"VEHICLE_NO",label:"车牌号码",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"STOP_TIME",label:"停报时间",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"STOP_REASON",label:"停报原因",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"UP_TIME",label:"上报日期",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"AUDIT_STATUS",label:"审核状态",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"AUDIT_TIME",label:"审核时间",align:"center",width:"140"}}),a("el-table-column",{attrs:{prop:"AUDIT_REASON",label:"审核原因",align:"center","min-width":"160",resizable:!1}}),a("el-table-column",{attrs:{resizable:!1,width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",icon:"el-icon-edit",type:"text"},on:{click:function(a){return e.handleTableEditClick(t.row)}}}),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"text"},on:{click:function(a){return e.handleTableDeleteClick(t.row)}}})]}}])})],1),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.display,width:"400px"},on:{"update:visible":function(t){return e.$set(e.dialog,"display",t)},closed:e.handleDialogClosed}},[a("el-form",{ref:"form",attrs:{model:e.dialog.form,size:"small","label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"车牌号码"}},[a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"260px"},attrs:{placeholder:"车牌号码（公司）","fetch-suggestions":e.handleVehicleCompanyQuerySearch,"trigger-on-focus":!1},model:{value:e.dialog.form.vehicle,callback:function(t){e.$set(e.dialog.form,"vehicle",t)},expression:"dialog.form.vehicle"}})],1),a("el-form-item",{attrs:{label:"报停原因"}},[a("el-input",{staticStyle:{width:"260px"},attrs:{type:"textarea",rows:2,placeholder:"报停原因"},model:{value:e.dialog.form.reason,callback:function(t){e.$set(e.dialog.form,"reason",t)},expression:"dialog.form.reason"}})],1),a("el-form-item",{attrs:{label:"报停时间"}},[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"datetime",placeholder:"报停时间"},model:{value:e.dialog.form.time,callback:function(t){e.$set(e.dialog.form,"time",t)},expression:"dialog.form.time"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.display=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleDialogSaveClick}},[e._v("提 交")])],1)],1)],1)},l=[],n=a("c1df"),o=a.n(n),r=a("0e08"),c=a("bc3a"),s=a.n(c),d=a("17fb"),p=a.n(d),m={name:"StopApplication",data:function(){return{query:{startTime:"",endTime:"",vehicle:""},inputVehicle:{loading:!1,option:[]},table:{display:!1,selectItem:[],data:[]},select:{vehicle:[],vehicle_company:[]},dialog:{title:"",display:!1,form:{vehicle:"",reason:"",time:""}}}},mounted:function(){this.query.startTime=new Date(o()().add("day",-1)),this.query.endTime=new Date,this.findStopApplication(),this.getVehicle()},methods:{iconClassName:r["m"],handleVehicleQuerySearch:function(e,t){if(e.length<3)return t([]);t(p.a.filter(this.select.vehicle,function(t){return t.value.indexOf(e)>-1}))},handleVehicleCompanyQuerySearch:function(e,t){if(e.length<3)return t([]);t(p.a.filter(this.select.vehicle_company,function(t){return t.value.indexOf(e)>-1}))},getVehicle:function(){var e=this;s.a.get("common/vehicle",{baseURL:r["a"],params:{type:1}}).then(function(t){e.select.vehicle=p.a.map(t.data,function(e){return{value:e.VEHICLE_NO}}),e.select.vehicle_company=p.a.map(t.data,function(e){return{value:e.VEHICLE_NO+"("+e.COMPANY_NAME+")"}})}).catch(function(e){console.log(e)})},findStopApplication:function(){var e=this,t=this.query,a=t.startTime,i=t.endTime,l=t.vehicle;this.table.display=!0,s.a.get("letterManagement/findStopApplication",{baseURL:r["a"],params:{startTime:a&&o()(a).format("YYYY-MM-DD"),endTime:i&&o()(i).format("YYYY-MM-DD"),vehicle:l}}).then(function(t){e.table.data=t.data||[],e.table.display=!1}).catch(function(e){console.log(e)})},addStopApplication:function(){var e=this,t=this.dialog.form,a=t.vehicle,i=t.reason,l=t.time;if(""===a||""===i||""===l)return this.$message.error("请填写完整信息！"),!1;s.a.get("letterManagement/addStopApplication",{baseURL:r["a"],params:{vehicle:a,reason:i,time:l&&o()(l).format("YYYY-MM-DD HH:mm:ss")}}).then(function(t){t.data>0?(e.$message({message:"操作成功!",type:"success"}),e.dialog.display=!1,e.findStopApplication()):0===t.data?e.$message.error("操作失败！"):-1===t.data&&e.$message.error("该车辆已申请！")}).catch(function(e){console.error(e)})},updateStopApplication:function(){var e=this,t=this.dialog.form,a=t.vehicle,i=t.reason,l=t.time;if(""===a||""===i||""===l)return this.$message.error("请填写完整信息！"),!1;s.a.get("letterManagement/updateStopApplication",{baseURL:r["a"],params:{id:this.table.selectItem.ID,vehicle:a,reason:i,time:l&&o()(l).format("YYYY-MM-DD HH:mm:ss")}}).then(function(t){t.data>0?(e.$message({message:"操作成功!",type:"success"}),e.dialog.display=!1,e.findStopApplication()):0===t.data?e.$message.error("操作失败！"):-1===t.data&&e.$message.error("该车辆已申请！")}).catch(function(e){console.error(e)})},handleQueryClick:function(){this.findStopApplication()},handleTableAddClick:function(){this.dialog.title="添加",this.dialog.display=!0},handleTableEditClick:function(e){this.dialog.title="修改",this.dialog.display=!0,this.table.selectItem=e,this.dialog.form.vehicle=e.VEHICLE_NO+"("+e.COMPANY_NAME+")",this.dialog.form.reason=e.STOP_REASON,this.dialog.form.time=e.STOP_TIME},handleTableDeleteClick:function(e){var t=this;this.$confirm("是否删除?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then(function(){s.a.get("letterManagement/deleteStopApplication",{baseURL:r["a"],params:{id:e.ID}}).then(function(e){e.data>0?(t.$message({message:"操作成功!",type:"success"}),t.findStopApplication()):t.$message.error("操作失败！")}).catch(function(e){console.error(e)})}).catch(function(){})},handleDialogSaveClick:function(){"修改"===this.dialog.title?this.updateStopApplication():"添加"===this.dialog.title&&this.addStopApplication()},handleDialogClosed:function(){this.dialog.title="",this.dialog.form.vehicle="",this.dialog.form.reason="",this.dialog.form.time="",this.table.selectItem=[]},handleExportClick:function(){var e=this.query,t=e.startTime,a=e.endTime,i=e.vehicle;this.$confirm("是否需要导出?","提示",{confirmButtonText:"是",cancelButtonText:"否",cancelButtonClass:"el-button--danger",closeOnClickModal:!1,type:"info",center:!0}).then(function(){window.open("".concat(r["a"],"letterManagement/findStopApplicationExcel?startTime=").concat(t&&o()(t).format("YYYY-MM-DD"),"&endTime=").concat(a&&o()(a).format("YYYY-MM-DD"),"&vehicle=").concat(i,"&type=",0))}).catch(function(){})}}},u=m,h=a("2877"),f=Object(h["a"])(u,i,l,!1,null,null,null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-2d0a3e2a.23014b4d.js.map